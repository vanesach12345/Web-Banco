<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultas - Dashboard Bancario</title>
    <link rel="stylesheet" href="consultas_eje.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <button class="menu-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
            <div class="header-title">
                <h1>Consultas</h1>
                <p>Operaciones bancarias estándar</p>
            </div>
            <button class="ejecutivo-button">Ejecutivo</button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Welcome Section -->
        <div class="welcome-section">
            <div class="welcome-text">
                <h2>Bienvenido, Ejecutivo Bancario</h2>
                <p>Historial de Movimientos</p>
            </div>
            <button class="notification-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
                <span class="notification-badge"></span>
            </button>
        </div>
<!-- Stats Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-content">
            <div class="stat-info">
                <h3 class="stat-label">Cuentas</h3>
                <p class="stat-value">{{ totalCuentas }}</p>
                <p class="stat-change">+12 este mes</p>
            </div>
            <div class="stat-icon purple">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect>
                    <line x1="9" y1="6" x2="15" y2="6"></line>
                    <line x1="9" y1="10" x2="15" y2="10"></line>
                    <line x1="9" y1="14" x2="15" y2="14"></line>
                </svg>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-content">
            <div class="stat-info">
                <h3 class="stat-label">Solicitudes Pendientes</h3>
                <p class="stat-value">{{ solicitudesPendientes }}</p>
                <p class="stat-change">Requieren autorización</p>
            </div>
            <div class="stat-icon yellow">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-content">
            <div class="stat-info">
                <h3 class="stat-label">Cuentas Cerradas</h3>
                <p class="stat-value">{{ cuentasCerradas }}</p>
                <p class="stat-change">faltantes 12</p>
            </div>
            <div class="stat-icon red">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-content">
            <div class="stat-info">
                <h3 class="stat-label">Total Movimientos</h3>
                <p class="stat-value">{{ totalMovimientos }}</p>
                <p class="stat-change">+15% vs ayer</p>
            </div>
            <div class="stat-icon green">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                    <polyline points="17 6 23 6 23 12"></polyline>
                </svg>
            </div>
        </div>
    </div>
</div>

        <!-- Content Grid -->
        <div class="content-grid">
           <!-- Filters Sidebar -->
<aside class="filters-sidebar">
    <div class="filters-header">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
        </svg>
        <h3>Filtros</h3>
    </div>
<!-- Filtro por Tipo de Movimiento -->
<div class="filter-group">
    <label class="filter-label">Tipo de Movimiento</label>
    <select id="movementTypeFilter" class="filter-select" [(ngModel)]="filter.tipoMovimiento">
        <option value="">Todos</option>
        <option value="Compras">Compras</option>
        <option value="Ingreso">Ingreso</option>
        <option value="Restaurantes">Restaurantes</option>
        <option value="Servicios">Servicios</option>
        <option value="Telefonía">Telefonía</option>
    </select>
</div>

<!-- Filtro por Número de Cuenta -->
<div class="filter-group">
    <label class="filter-label">Numero de Cuenta</label>
    <select id="accountNumberFilter" class="filter-select" [(ngModel)]="filter.numeroCuenta">
        <option value="">Todos</option>
        <option value="Cuenta Corriente">Cuenta Corriente</option>
        <option value="Tarjeta Débito">Tarjeta Débito</option>
    </select>
</div>

<!-- Filtro por Nombre del Usuario -->
<div class="filter-group">
    <label class="filter-label">Nombre del Usuario</label>
    <select id="userNameFilter" class="filter-select" [(ngModel)]="filter.usuario">
        <option value="">Todos</option>
        <option value="maria-gonzalez">Maria Gonzalez</option>
        <option value="juan-perez">Juan Pérez</option>
        <option value="ana-rodriguez">Ana Rodríguez</option>
        <option value="carlos-lopez">Carlos López</option>
    </select>
</div>

<!-- Filtro por Fecha -->
<div class="filter-group">
    <label class="filter-label">Fecha</label>
    <input type="date" class="filter-select" [(ngModel)]="filter.fecha">
</div>

<button id="applyFiltersBtn" class="apply-filters-button" (click)="aplicarFiltros()">Aplicar Filtros</button>
<button id="clearFiltersBtn" class="clear-filters-button" (click)="limpiarFiltros()">Limpiar</button>
</aside>

<!-- Transactions List -->
<section class="transactions-section">
    <div class="transactions-header">
        <h3>Todas las Transacciones</h3>
        <!-- Mostrar mensaje si no hay transacciones -->
<div *ngIf="transacciones.length === 0">
  <p>No se encontraron transacciones.</p>
</div>

        
    </div>
<!-- Lista de transacciones renderizadas por Angular -->
<div *ngIf="transacciones.length === 0">
  <p>No se encontraron transacciones.</p>
</div>

<div *ngFor="let transaccion of transacciones" class="transaction-item">
  <div class="transaction-details" (click)="seleccionarTransaccion(transaccion)">
    <div class="transaction-name">{{ transaccion.descripcion }}</div>
    <div class="transaction-meta">
      <span class="transaction-date">{{ transaccion.fecha }}</span>
      <span class="transaction-category">{{ transaccion.tipo_movimiento }}</span>
      <span class="transaction-account">{{ transaccion.cuenta_origen }}</span>
    </div>
  </div>
  <div class="transaction-amount-section">
    <div class="transaction-amount" [ngClass]="transaccion.monto > 0 ? 'positive' : 'negative'">
      {{ transaccion.monto | currency }}
    </div>
    <div class="transaction-status">{{ transaccion.estado }}</div>
  </div>
</div>

<!-- Detalle de la transacción seleccionada -->
<div *ngIf="isTransaccionVisible" class="transaction-details-container">
  <h3>Comprobante de Transacción</h3>
  <p><strong>Descripción:</strong> {{ transaccionSeleccionada.descripcion }}</p>
  <p><strong>Fecha:</strong> {{ transaccionSeleccionada.fecha | date:'dd/MM/yyyy' }}</p>
  <p><strong>Folio:</strong> {{ transaccionSeleccionada.folio }}</p>
  <p><strong>Cuenta de Origen:</strong> {{ transaccionSeleccionada.id_cuenta_origen }}</p>
  <p><strong>Monto:</strong> {{ transaccionSeleccionada.monto | currency }}</p>
  <p><strong>Estado:</strong> {{ transaccionSeleccionada.estado }}</p>

  <!-- Botón para exportar a PDF -->
  <button id="exportBtn" class="export-button" (click)="exportToPDF()">Exportar a PDF</button>
</div>
</section>
        </div>
    </main>